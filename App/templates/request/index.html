{% extends "layout.html" %}
{% block title %}Recommendation Requests{% endblock %}
{% block page %}{{ current_user.getName() }}'s Recommendation Requests{% endblock %}

{% block link%}
<ul id="nav-mobile" class="right">
    <li><a href="/logout">Logout</a></li>
</ul>
{% endblock %}

{{ super() }}

{% block content %}
<main class="container">
    <div class="card">
        <div class="card-content">
            <span class="card-title">Request a Recommendation</span>
            <form action="/recommendation_request" method="POST">
                <div class="row">
                    <div classs="input-field">
                        <label for="staffID">Staff</label>
                        {% if teachers %}
                        <select placeholder="staffID" name="staffID" id="staffID" style="display:inline">
                            {% for teacher in teachers %}
                            <option value="none" selected disabled hidden>Select a lecturer</option>
                            <option value="{{teacher.staffID}}">{{teacher.firstName}} {{teacher.lastName}} </option>
                            {% endfor %}
                        </select>
                        {% else %}
                        <select placeholder="staffID" name="staffID" id="staffID" style="display:inline"
                            onmousedown="(function(e){ e.preventDefault(); })(event, this)">
                            <option> No lecturers available</option>
                        </select>
                        {% endif %}
                    </div>
                    <div classs="input-field">
                        <label for="requestBody">Description</label>
                        <textarea placeholder="Enter a message here" name="requestBody" id="requestBody" type="text"
                            class="materialize-textarea" {% if not teachers %} disabled {% endif %}></textarea>
                    </div>
                    <div classs="input-field">
                        <label for="deadline">Deadline</label>
                        <input placeholder="01-01-1970" name="deadline" id="deadline" type="date" value="{{today}}" {%
                            if not teachers %} disabled {% endif %} />
                    </div>

                    <div classs="card-action">
                        <input type="submit" class="green text-white btn" value="Request" {% if not teachers %} disabled
                            {% endif %}>
                    </div>

                </div>

            </form>
        </div>
    </div>
    {% if requests %}
    <table>
        <tr>
            <th>RequestID</th>
            <th>Message</th>
            <th>ProfessorID</th>
            <th>Date Requested</th>
            <th>Deadline</th>
            <th>Status</th>
            <th>Recommendation</th>
        </tr>
        {% for r in requests %}
        <tr>
            <td>{{r.reqID}}</td>
            <td>{{r.requestBody}}</td>
            <td>{{r.staffID}}</td>
            <td>{{r.dateRequested}}</td>
            <td>{{r.deadline}}</td>
            <td>{{r.status.value}}</td>

            {% if r.Recommendation %}
            <td>
                <a href="/recommendation/{{ r.Recommendation.recID }}">
                    View Recommendation
                </a>
            </td>
            {% else %}
            <td>Not available</td>
            {% endif %}
        </tr>
        {% endfor %}
    </table>
    {% else %}
    <p> You have no Recommendation Requests create one :-D</p>
    {% endif %}
</main>
{% endblock %}